# CRM
#dev branch
##### CRM - Система управления взаимоотношениями с клиентами (CRM, CRM-система, сокращение от англ. Customer Relationship Management) — прикладное программное обеспечение для организаций, предназначенное для автоматизации стратегий взаимодействия с заказчиками (клиентами), в частности для повышения уровня продаж, оптимизации маркетинга и улучшения обслуживания клиентов путём сохранения информации о клиентах и истории взаимоотношений с ними, установления и улучшения бизнес-процессов и последующего анализа результатов.

## Страница логина/регистрации.
![alt text](https://avatars.mds.yandex.net/get-pdb/1080201/84619181-2215-49a9-8337-1a6078e7e1b0/s1200) 
***Страница логина/регистрации***


Описание:
Страница логина содержит 2 поля для ввода логина и пароля и 2 кнопки для входа и регистрации. (смотри ***Страница логина/регистрации***)
При нажатии на кнопку регистрации открывается страница регистрации:

![alt text](https://avatars.mds.yandex.net/get-pdb/1536452/71e767fc-f598-4707-b7fd-7844fe3f6bdb/s1200)
***Страница регистрации***
##  Доска  
После успешного логина в систему, появится основная страница — Доска.

![alt text](https://pp.userapi.com/c850724/v850724854/c9d42/19IGnZrplZ0.jpg)
***Доска***

Доска содержит следующие элементы, отмеченные указателями на ***Доска***(номера указателей совпадают с порядком перечисления элементов) :

# 1. Карточка клиента

Описание:  Карточка находится на доске, в колонке, который определен статусом. На карточке есть минимальная необходимая информация — Фамилия и Имя.
Статус клиента можно определить по колонке, в которой находится карточка. Красный колокольчик — уведомление, что карточка новая и не открывалась(при открытии колокольчик исчезнет). В правом верхнем углу есть кнопка(ручка), при нажатии на которую можно назначить/поменять сотрудника клиенту и произвести другие действия с клиентом. Когда сотрудник назначен, в карточке появляется соответствующая отметка (инициалы сотрудника) выше имени клиента.

Так же на карточке находится значок письма, при открытии которого открывается форма для быстрой отправки сообщения одним из шаблонов на выбор(***Доска***, указатель 9):

![alt text](https://pp.userapi.com/c850724/v850724854/c9d49/ukn5YbQOGEI.jpg)
***Карточка клиента***

После выбора одного из шаблонов, откроется окно с способом отправки сообщения:

![alt text](https://avatars.mds.yandex.net/get-pdb/1636338/e036decf-beff-4285-abb0-fea2ae777745/s1200)
***Способ отправки сообщения***

После открытия карточки, перед вами появится информация о клиенте:

![alt text](https://pp.userapi.com/c854024/v854024466/f967/o6LJZkqpLfg.jpg)
***Информация о клиенте***

Основные функции внутри карточки (отмечены на ***Информация о клиенте*** указателями, номера которых соответствуют перечеслению функций):

1. Добавить напоминание

Описание: При нажатии на кнопку добавить напоминание, динамически откроется область для добавления напоминания (смотри ***Добавить напоминание*** ниже).
Если отметить поле "Скрывать?", карточка клиента скроется из доски до времени срабатывания напоминания.

![alt text](https://avatars.mds.yandex.net/get-pdb/1647366/5f199d77-51da-4736-b648-2eb98fdd7f86/s1200)
***Добавить напоминание***

2. Расширенная информация

Описание: При нажатии на данную кнопку, откроется страничка с информацией о клиенте:

![alt text](https://pp.userapi.com/c850432/v850432536/ea3c9/Ycnm-lF24Nc.jpg)
![alt text](https://avatars.mds.yandex.net/get-pdb/1057758/89dd175d-528f-4f7f-bb0c-a58ad7335423/s1200)
***Расширенная информация***

Чтобы редактировать информацию, нужно нажать на кнопку редактировать (смотри ***Расширенная информация***), затем сохранить изменения.

Около кнопки редактирования располагается кнопка «смотреть отзывы», по нажатию будет открыто следующее окно:

![alt_text](https://pp.userapi.com/c850432/v850432536/ea3bf/ms6Y3demFkk.jpg)
***Добавить отзывы***

Кнопка «добавить отзыв», добавляет поле с 3мя ячейками (Ссылка на соц сеть, Текст отзыва, Ссылка на видео).
Чтобы сохранить добавленный отзыв, нужно нажать на зеленую кнопку. Чтобы удалить - красную.

Также в расширенной информации есть возможность просмотра Истории клиента, по нажатию на кнопку «Открыть историю»:

![alt text](https://avatars.mds.yandex.net/get-pdb/1483515/49b0c495-ae69-402d-aca1-32b1edd47f80/s1200)
***История клиента***

3. Взять себе карточку

Описание: При нажатии на кнопку «Взять себе карточку» карточка присваивается текущему залогиненному пользователю. После этого кнопка меняет цвет на желтый и появляется возможность открепить карточку.

![alt text](https://avatars.mds.yandex.net/get-pdb/1515467/8fc04e17-8a6f-4ed3-8192-d0ef60318936/s1200)
***Взять себе карточку***

4. Назначить беседу в Skype
Описание:
При нажатии на кнопку «Назначить беседу в Skype», в случае отсутствия информации о Skype в карточке, будет предложено добавить эту информацию:

![alt text](https://avatars.mds.yandex.net/get-pdb/1551019/84733dc5-12f3-4fd4-a311-5f60c2225429/s1200)
***Назначить беседу в Skype***

Затем появится возможность выбрать дату и время созвона, будет возможность напомнить клиенту о созвоне сообщением, а так же будет предложено выбрать ментора.

![alt text](https://avatars.mds.yandex.net/get-pdb/1551019/b954dc46-b89f-4e82-af12-fc8ba5bacd1c/s1200)
***Выбор даты, времени и ментора для созвона***

5. Возможность позвонить клиенту прямо из CRM, нажав на кнопку телефона (смотри ***Информация о клиенте***, указатель 5).
При звонке кнопка окрасится в зеленый цвет.
Так же есть возможность просмотреть историю звонков, прослушать записанный разговор или просто скачать аудиозапись.

6. Отправить сообщение клиенту 

Описание: При нажатии на кнопку «Конверт»,  (смотри ***Информация о клиенте***, указатель 6) откроется окно:

![alt text](https://avatars.mds.yandex.net/get-pdb/1636338/1f9b34cc-e2c8-4691-998a-f7cd8ab442c7/s1200)
***Отправить сообщение клиенту***

При выборе любого из пунктов: После разговора, оплата за обучение и т. д., откроется окно.
В поле ввода можно добавить текст, кроме того можно выбрать вид сообщения (sms, e-mail…).
Также присутствуют кнопки для выбора сразу всех видов сообщений и для очистки выбранных видов.

Также есть возможность перейти в редактирование шаблонов по нажатию кнопки во 2 столбце.

7.  Возможность открыть чат с пользователем во Вконтакте или другой соц.сети прямо из CRM.

8. Договор. При нажатии на кнопку откроется модальное окно для создания ссылки на оформение договора.

![alt_text](https://pp.userapi.com/c854024/v854024466/f95d/CeiKJRgDNGs.jpg)
***Создание ссылки для оформлдения договора***

Чекбокс «Разовая?», если "галочка" стоит, будет оформлен разовый договор, иначе с помесячной оплатой.
Чекбокс «Диплом», если "галочка" стоит, в договор будет включен пункт о выдаче диплома.
Поле сумма платежа - выставление цены на услуги.
При нажатии на кнопку «Сгенерировать ссылку», в соседней форме появится ссылка, по которой пользователь может заполнить форму(***Форма для получения договора на гугл диск***) 
и получить копию договора, которая будет сохранена на гугл диске

![alt_text](https://pp.userapi.com/c854024/v854024466/f982/7fFKI8tSa9U.jpg) 
***Форма для получения договора на гугл диск***

## 2. Статус клиента и кнопка редактирования статуса на доске

Описание: Статус позволяет визуально разбить клиентов на определенные колонки и видеть текущее положение клиента по статусу(например inLearning — в процессе обучения или New Clients — новый клиент) — смотри ***Доска***, указатель 2-3.

Для редактирования статуса на доске существует кнопка (шестеренка):

![alt text](https://avatars.mds.yandex.net/get-pdb/1636338/49bfe071-d505-4c02-827d-4aea977285bd/s1200)
***Редактирование статуса клиента***

При добавлении клиента — откроется форма добавления клиента:

![alt text](https://avatars.mds.yandex.net/get-pdb/1532005/59afb033-a460-4987-94cf-21ced4fbe715/s1200)
***Форма добавления клиента***

При удалении статуса, будет выведено подтверждение действия и в случае согласия, статус и все клиенты в нем будут удалены с доски.

Так же можно изменить название статуса, скрыть его(пропадет с доски со всеми клиентами, но не будет удален) и поменять положение, выбрав в списке существующие статусы — это можно так же сделать путем перетаскивания карточек мышкой на доске.

И, наконец, можно сделать данный статус "студентом". Если галочка выставлена, то при переносе карточек из соседних колонок в этот статус, если клиент не был студентом он им станет. То есть, его профиль появится во вкладке "Все студенты" навбара.

Добавить статус возможно в специально отведенном для этого поле ввода (смотри ***Доска***, указатель 4)

## 3. Меню

Описание: Меню открывается по одноименной кнопке в верхнем правом углу доски (смотри ***Доска***, указатель 5)

![alt text](https://pp.userapi.com/c850432/v850432536/ea3b5/afOYChuL-30.jpg)

***Меню***

Список функций раздела «Меню»:
1. Просмотр скрытых статусов

2. Редактирование/удаление/деактивация сотрудника.

Описание: в разделе «Список сотрудников» перечислены их имена и существуют 3 кнопки:
1 кнопка позволяет редактировать сотрудника, 2 кнопка его деактивирует с возможностью активировать и 3 удаляет (нумерация в соответствии с номерами столбцов)

4. Возможность «принять» или «отклонить» сотрудника из списка «новые сотрудники».

5. Добавить сотрудника.
Описание: При нажатии на кнопку добавить пользователя — откроется страница, в которой нужно заполнить данные сотрудника:

![alt text](https://avatars.mds.yandex.net/get-pdb/1511346/784afacb-e703-42c6-b8f8-a37cbe67b6f4/s1200)
***Окно для добавления сотрудника(пользователя)***

6. Отслеживаемые группы VK
Описание:

![alt text](https://avatars.mds.yandex.net/get-pdb/1535458/eb53ddff-8f0d-4720-991d-3ff132568890/s1200)
***Отслеживаемые группы VK***

![alt text](https://avatars.mds.yandex.net/get-pdb/1523412/afd20c6b-6182-46b0-9945-7cacc277963b/s1200)
***Добавление новой группы в отслеживаемые группы VK***

![alt text](https://avatars.mds.yandex.net/get-pdb/1532005/c70663c5-f4a6-46cb-9360-f73417551d40/s1200)
***Редактирование отслеживаемой группы в VK***

Данная функция нужна для отслеживания новых участников группы и отправки им сообщения, например «Привет, хочешь изучать Java?».
Групп может быть несколько, данные о них можно изменять или вообще удалить.

При добавлении новой группы (***Добавление новой группы в отслеживаемые группы VK***), нужно указать имя группы (не обязательно, чтоб совпадало с группой Вк), id группы, токен своей группы и clientId своего приложения вконтакте. Более подробное описание есть в подсказах формы добавления.
Для отправки сообщений - нужно указать свой логин и пароль от ВК страницы в vk.properties.

Изменение данных об отслеживаемой группе (***Редактирование отслеживаемой группы в VK***)

5. Отслеживаемая трансляция YouTube
Описание: 

![alt text](https://avatars.mds.yandex.net/get-pdb/1080201/9f6acdc2-e023-47c0-8aca-f3ddf26e97d7/s1200)
***Отслеживаемая трансляция на YouTube***

Отслеживание YouTube трансляции позволяет производить поиск потенциальных клиентов в группе Вк по чату во время трансляции на YouTube.

На ***Отслеживаемая трансляция на YouTube*** можно наблюдать 4 поля:

1. Поле для ввода ссылки/id YouTube канала - канал, на котором будет "просматриваться" чат.
2. Поле для ввода ссылки/id для группы Вконтакте - группа, в которой будет вестись поиск клиентов.
3. Название YouTube канала
4. Описание канала

Кнопка «отправить» добавляет канал в отслеживаемые. По окончанию трансляции, можно скачать текстовый файл с id потенциальных клиентов, по нажатию кнопки «Скачать txt файл со всеми vk id потенциальных клиентов».

6. Отчёт
Описание:

![alt text](https://avatars.mds.yandex.net/get-pdb/1222203/512aff63-4102-41cd-b40d-c54044936cf2/s1200)
***Отчёт***

Для создания отчёта нужно выбрать дату, сделать сам отчёт (поле ввода растягивается на нужный для пользователя размер), затем указать Email и отправить.

Также присутствуют дополнительные настройки:

![alt text](https://avatars.mds.yandex.net/get-pdb/1566774/8959778c-32aa-47ad-9252-625bb8d3bfd4/s1200)
***Отчет - дополнительные настройки***

7. Посмотреть все отзывы

![alt_text](https://pp.userapi.com/c850432/v850432536/ea39f/UlqyQpsRogo.jpg)
***Таблица всех отзывов***

Описание: 
1.  Чекбокс на показ клиентов у которых нет отзывов
2.  Поле для ввода, для поиска клиентов
3.  Фильтрация по таблице
4.  редактирование отзывов

## 4. Кнопка профиля SS (Stanislav Sorokin) + Настройки + Профиль

Описание: Круглая кнопка в правом верхнем углу, доступна из любой области в CRM.
При нажатии на кнопку появляется выбор — Перейти в настройки, настроить профиль или выйти.

![alt text](https://pp.userapi.com/c845016/v845016871/1e1007/bFIQIKqhBzk.jpg)
***Настройки профиля***

### Настройки

В настройках расположены следующие кнопки:

1. Изменить профиль

Описание: 
Переход на страницу редактирования профиля текущего пользователя.

![alt text](https://avatars.mds.yandex.net/get-pdb/1604590/c4e67d63-959a-43b4-8baa-1b203e1c7574/s1200)
***Настройки - Изменить профиль***

Чтобы редактировать свой профиль, нужно разрешить редактирование, нажав на кнопку «Редактировать».
С вводимыми данными можно ознакомится на ***Настройки - Изменить профиль***.

2. Настройка оформления

Описание: 
При нажатии на кнопку «Настройка оформления» появляется окно с палитрой

![alt text](https://avatars.mds.yandex.net/get-pdb/1384526/f3e80831-8b59-4401-988b-9f15c205c19b/s1200)
***Настройки - Настройка оформления***

Выбираем цвет на палитре, нажимаем кнопку применить и цвет фона поменяется на выбранный.

3. Авторизация вконтакте

Описание: 
Нажимаем кнопку получить токен, открывается окошко — копируем ссылку и вставляем в указанное поле.

![alt text](https://avatars.mds.yandex.net/get-pdb/1485236/ae84f59a-f343-4687-a1f6-f91864f4a7fd/s1200)
***Настройки - Авторизация вконтакте***

4. Настроить форму заявки ВК

Описание: При нажатии на кнопку открывается страница настройки, которая представляет из себя таблицу с названием поля в заявке ВК и её типом (обязательная — вся информация о клиенте или не обязательная — например заметки)
Порядок строк в таблице, должен соответствовать порядку заполнения полей в заявке ВК, изменить номер строки в таблице можно путём перетаскивания мышкой. Строки можно добавлять, изменять и удалять.

![alt text](https://avatars.mds.yandex.net/get-pdb/1648099/fbcda12c-8490-490d-857c-7a6401eed747/s1200)
***Настройки - Настроить форму заявки в ВК*** 

5. Авторизация Google

Описание: Стандартная oauth авторизация в гугл.
Нужна для отправки и сохранения договоров!

6. Настроить автоответ

Описание: Предлагает настроить автоответ (сообщение, которое будет отправлено потенциальному клиенту), для этого нужно выбрать заранее подготовленный шаблон из списка. Чтобы отключить автоответ, нужно выбрать пункт "Не выбрано" и нажать "Применить".

![alt text](https://pp.userapi.com/c850724/v850724854/c9d79/m8CmC0noFmY.jpg)
***Настройки - Настроить автоответ***

7. Настройки договора

Описание: Предлагает указать следущие установки для договора: 
Шаблон для рассылки(сообщение которое будет отправлено вместе с договором на email),
Последний номер договора(вводится 1 раз, с каждым след. договором автоматичски увеличивается),
Реквизиты

![alt text](https://pp.userapi.com/c854024/v854024466/f979/BFwMSHjgXxU.jpg)
***Настройки - Настройка договора***

8. Статусы по-умолчанию

Описание: Позволяет задать статусы новым клиентам. Смотри ***Настройки - Статусы по умолчанию*** ниже

![alt text](https://avatars.mds.yandex.net/get-pdb/1679414/59dc3c0e-395f-4571-8a07-b8b22a65d11b/s1200)
***Настройки - Статусы по-умолчанию***

9. Настройка оповещения

Описание: ***Настройки - Настройка оповещения***

![alt text](https://avatars.mds.yandex.net/get-pdb/1511346/6219ab61-ae54-4527-8549-80aaf800bfd1/s1200)
***Настройки - Настройка оповещения***

10. Параметры по-умолчанию для студентов

Описание: ***Настройки - Параметры по-умолчанию для студентов***

![alt text](http://dl4.joxi.net/drive/2019/04/06/0028/2810/1862394/94/34e33de73e.jpg)
***Настройки - Параметры по-умолчанию для студентов***

11. Авторизация в Telegram

Описание: ***Настройки - Авторизация в Telegram***

![alt text](http://dl4.joxi.net/drive/2019/04/06/0028/2810/1862394/94/2add4889dd.jpg)
***Настройки - Авторизация в Telegram***

## 5. Оповещения:

Описание:

![alt text](https://avatars.mds.yandex.net/get-pdb/1532005/3d043e99-e82d-4865-944c-3d5855ef97a7/s1200)

***Оповещения***

1. По нажатию на уведомление о новом клиенте — оно пропадет с доски (красный колокольчик на карточке клиента).
2. При нажатии на корзинку — удалятся все оповещения о  клиентах.

## 6. Верхний навбар

Описание: смотри ***Доска***, указатель 10.
Предназначен для удобной навигации по CRM.
Состоит из 6 ссылок и полей для поиска на доске (смотри ***Доска***, указатель 8 и 10)
Некоторые из них уже рассматривались в описании.

### Все клиенты

![alt text](https://pp.userapi.com/c850724/v850724854/c9d83/fhq3tAEOIsg.jpg)
***Все клиенты***

При переходе на страницу «все клиенты», выводится таблица всех клиентов с информацией о них.
На странице находится поле ввода для поиска клиента.
Так же присутствует фильтр:

![alt text](https://avatars.mds.yandex.net/get-pdb/1636338/0f39f0d8-b3a7-4d1e-9413-3001fa68d48a/s1200)
***Все клиенты - фильтр***

При выставлении значений в фильтр, нажимается кнопка «Найти» и поиск клиента производится по заданному условию. 
При желании можно скачать данные о клиенте. Чтобы обновить список клиентов, нужно нажать enter.

На ***Все клиенты - фильтр*** можно наблюдать кнопку «Вернуть» в столбце «Скрыт?».
 Это означает, что клиент с данным статусом скрыт и не отображается на главное доске. 
Чтобы вернуть клиента на доску, нужно нажать на кнопку «Вернуть» и выбрать статус, в который вернется клиент.

У колонки "Статус" есть кнопка "шестеренка", при нажатии на которую можно задать различные цвета для клиентов с определенным статусом.

По нажатию кнопки «Добавить клиента», откроется страничка создания клиента:

![alt text](https://avatars.mds.yandex.net/get-pdb/1515467/bf955440-e0ec-4444-92e7-ef4a546da61d/s1200)
***Все клиенты - добавить клиента***

Для добавления клиента вводим все данные и нажимаем кнопку Сохранить, у полей есть валидация, которая уменьшит % ошибок при вводе данных.
После создания, на главной доске появится карточка клиента в выбранном  статусе.

Функция "Массовый ввод" позволяет создавать несколько клиентов одним запросом, для этого данные клиентов вводятся в поля формы построчно. 
См. ***Все клиенты - массовый ввод*** ниже.

![alt text](https://pp.userapi.com/c850724/v850724854/c9d8d/v_5XAkdV-wQ.jpg)
***Все клиенты - массовый ввод***

### Все студенты

![alt text](https://avatars.mds.yandex.net/get-pdb/1630840/78c67d39-9598-4e35-9caf-7e5f28b0fe53/s1200)
***Все студенты***

Таблица всех студентов содержит в себе информацию о студентах, которую можно редактировать (смотри скриншот выше).

Пример изменения студента с именем «Иван Федоров»:

![alt text](https://avatars.mds.yandex.net/get-pdb/1063070/7c45a948-c4d1-46cd-bf54-01bc5c65cfec/s1200)
***Редактирование студента с именем "Иван Федоров""***

Или удалить студента вообще, для этого нужно нажать на красный крестик.
Над таблицей находится поле ввода для поиска студента.
Так же есть возможность использовать фильтр, нажав на кнопку «Фильтр»:

![alt text](https://avatars.mds.yandex.net/get-pdb/1080201/d15ea56d-84a9-474e-a20c-f009b8f22163/s1200)
***Таблица всех студентов - "Фильтр"***

### Статусы обучения

![alt text](https://avatars.mds.yandex.net/get-pdb/1535458/66d9e84d-7bf1-42d7-a8e4-f2a7becd292a/s1200)
***Статусы обучения***

В таблице статусов можно редактировать/удалять статусы (смотри скрин выше), а так же искать статус, для этого над таблицей 
находится поле ввода для поиска.

Над таблицей так же находится кнопка «Создать», которая позволяет создать новый статус.

Примеры создания и изменения статусов соответственно:

![alt text](https://avatars.mds.yandex.net/get-pdb/1535458/4af778a0-a003-4c68-bc18-25e024076fe9/s1200)
***Статусы обучения - создание статуса***

![alt text](https://avatars.mds.yandex.net/get-pdb/1532005/082afaea-66d5-4b37-b6c9-f5d6e608e730/s1200)
***Статусы обучения - редактирование статуса***

### Рассылка

![alt text](https://pp.userapi.com/c850724/v850724854/c9d5d/cOfPS7BC-G4.jpg)
***Рассылка***

Назначение: Рассылка предназначена для отправки сообщений клиенту тремя способами:
1. На электронную почту
2. SMS - сообщение
3. Сообщение Вконтакте.

На ***Рассылка*** указан вариант отправки на электронную почту, в поле сверху вводится текст сообщения,
 в поле снизу построчно вводятся адреса электронной почты получателей, каждый с новой строки.

Рассылка SMS: Аналогично отправке по электронной почте. В нижнее поле вводим номера телефонов получателей в формате "+71234567890".

Рассылка ВК: В нижнее поле вводятся id получателей по одному на строку, не более 20 в день. Также необходимо выбрать пользователя, 
от имени которого будет осуществляться рассылка.

![alt text](https://pp.userapi.com/c850724/v850724854/c9d67/HMPfxET8N10.jpg)
***Рассылка ВК***

### Шаблоны

![alt text](https://avatars.mds.yandex.net/get-pdb/1515467/79a4a78a-f948-409c-a1d7-b59be81ea02f/s1200)
***Таблица шаблонов рассылки***

Назначение: задать какой-либо шаблон рассылки для разных ситуаций (Оплата за обучение и т.д.).
Шаблон можно редактировать, нажав на кнопку (1). Удалить шаблон можно нажав на кнопку (2).
Пример редактирования шаблона:

![alt text](https://avatars.mds.yandex.net/get-pdb/1080201/bac125bb-ec7b-4068-99e6-7118cf87ca31/s1200)
***Редактирование шаблона рассылки***

В редакторе можно использовать различные опции форматирования, загрузить картинку и т. д.

## 7. Настройка для сообщений ВКонтакте

Система автоматически обрабатывает поступающие заявки из привязанной группы ВКонтакте.

Для правильного взаимодействия с группой необходимо проделать следующие шаги:
1. Настроить vk.properties
2. Группа должна быть публичной, у группы должны быть активированы сообщения
3. В группе необходимо установить приложение "Заявки" (https://vk.com/app5708398)
4. В приложении необходимо настроить поля также, как они заданы в форме заявки ВК (***Настройки для сообщений ВКонтакте - настройка полей*** ). 
См.пример ниже:

![alt text](https://pp.userapi.com/c852128/v852128842/c8668/y1XcyBmlYEA.jpg)
***Настройки для сообщений ВКонтакте - настройка полей***

5. В настройках приложения необходимо активировать оповещение администратора о новых заявках. См.пример ниже:

![alt text](https://pp.userapi.com/c852128/v852128842/c8671/fvaRoQ07vxA.jpg)
***Настройки для сообщений ВКонтакте - активация опопвещения администратора***

6. Из-под аккаунта администратора, которому будут пересылаться заявки, необходимо пройти авторизацию ВК в CRM. Выполняется из меню, см.***Настройки - Авторизация вконтакте***.

## 7. Настройка продвижения ВКонтакте

Система автоматически рассылает приглашения в друзья с промо-сообщением по списку id пользователей ВКонтакте.

Переход к функционалу осуществляется по ссылке "Продвижение" (см.***Доска***, пункт 10).

![alt text](https://pp.userapi.com/c844721/v844721210/1bb937/Hesw7iJtXu0.jpg)
***Доска - Продвижение***

Для начала нужно создать новую компанию, нажав кнопку "Создать". Появится форма с полями для заполнения:

![alt text](https://pp.userapi.com/c844721/v844721210/1bb93f/n2FjLGaQEe4.jpg)
***Продвижение - создание новой компании***

1. Название компании - используется только внутри системы, можно ввести любое.
2. VK ID приложения - сюда необходимо ввести ID вашего приложения. Как его получить, написано ниже. 
3. Текст для запроса - сюда вводится промо сообщение, которое будет отправляться вместе с запросом в друзья.
4. Допускать повторы от того же пользователя - установите галочку, если необходимо слать запросы повторно.

После нажатия "Создать", откроется следующая страница:

![alt text](https://pp.userapi.com/c844721/v844721210/1bb9a0/yeJoRqOjgDE.jpg)
***Продвижение - Создание компании с заданным именем***

Здесь необходимо нажать кнопку "Получить токен". Заявки в друзья будут отправляться от того пользователя, под которым вы получите токен.
 Нажав на кнопку, необходимо дать разрешения для приложения и затем вкопировать URL из адресной строки в поле ниже.

После этого останется выбрать текстовый файл, который содержит в себе id пользователей ВКонтакте, которым будут рассылаться заявки в друзья. 
По одному id на строку.

После успешного создания кампании, необходимо её запустить (смотри ***Доска - Продвижение***), для этого нужно нажать соответствующую кнопку в строке с кампанией 
(столбец "Действия"). Заявки в друзья рассылаются по расписанию, не более 20 заявок в день от одного пользователя (ограничение платформы vk).

### Приложение VK

Необходимо создать Standalone приложение, для этого нужно перейти по ссылке https://vk.com/editapp?act=create придумать любое название своему приложению
 и установить параметр "платформа" - "Standalone-приложение":

![alt text](https://pp.userapi.com/c844721/v844721210/1bb98e/VfV_mfq3FDM.jpg)
***Создание Standalone приложения***

Далее необходимо перейти во вкладку "Настройки" и выставить состояние "Приложение включено и доступно всем", затем нажать "Сохранить изменения":

![alt text](https://pp.userapi.com/c844721/v844721210/1bb997/YblagzFxt_Y.jpg)
***Изменение состояния приложения (включение "Приложение включено и доступно всем")***

На этой же странице находится поле "ID приложения", именно этот ID необходимо вставить в поле "VK ID приложения".

## 8. Настройка Telegram

Мессенджинг через Telegram имеет функционал, аналогичный ВКонтакте - создание новых клиентов на основе поступающих сообщений, общение из карточки клиента.

### Установка TDLib в Windows

Для подключения функционала Telegram необходимо скомпилировать и установить библотеку TDLib. На примере ОС Windows 10:
1. Установить Microsoft Visual Studio 2015 или более новую
2. Выбрать для установки компоненты (обязательно):
* Windows 8.1 SDK
* Инструменты Visual C++ для CMake
* Пакет SDK для Windows 10
* Английский языковой пакет
3. Скачать и установить gperf (https://sourceforge.net/projects/gnuwin32/files/gperf/3.0.1/), добавить путь к gperf.exe к системной переменной PATH.
4. Установить vcpkg (https://github.com/Microsoft/vcpkg#quick-start):
* git clone https://github.com/Microsoft/vcpkg.git
* cd vcpkg
* .\bootstrap-vcpkg.bat
* .\vcpkg integrate install
* .\vcpkg install sdl2 curl
* .\vcpkg.exe install openssl:x64-windows openssl:x86-windows zlib:x64-windows zlib:x86-windows
5. Скачайте и установить CMake (https://cmake.org/download/), обязательно отметьте пункт "Add CMake to the system PATH" при установке, либо вручную добавьте путь к CMake к системной переменной PATH.
6. Соберить TDLib:
* git clone https://github.com/tdlib/td.git
* cd <ПУТЬ_К_TDLib>
* mkdir jnibuild
* cd jnibuild
* cmake -DCMAKE_BUILD_TYPE=Release -DTD_ENABLE_JNI=ON -DCMAKE_INSTALL_PREFIX:PATH=../example/java/td .. –A x64 -DCMAKE_TOOLCHAIN_FILE=<ПУТЬ_К_РЕПОЗИТОРИЮ_VCPKG>/scripts/buildsystems/vcpkg.cmake
* cmake --build . --target install --config Release
* cd <ПУТЬ_К_TDLib>/example/java
* mkdir build
* cd build
* cmake -DCMAKE_BUILD_TYPE=Release -DTd_DIR=<ПУТЬ_К_TDLib>/example/java/td/lib/cmake/Td -DCMAKE_INSTALL_PREFIX:PATH=.. ..
* cmake --build . --target install --config Release
7. TDLib собран! Теперь необходимо путь <ПУТЬ_К_TDLib>/example/java/build/Release добавить к системной переменной PATH.
8. Проверить TDLib:
* cd <ПУТЬ_К_TDLib>/example/java/bin
* java -Djava.library.path=. org/drinkless/tdlib/example/Example
9. Если TDLib "ругается" на отсутствующие библиотеки, перейдите в <ПУТЬ_К_TDLib>/example/java/build/Release и скопируйте файлы "LIBEAY32.dll", "SSLEAY32.dll", "zlib1.dll" в папку C:\Windows.
10. При необходимости, к параметрам запуска проекта добавьте настройки VM Options: "-Djava.library.path=<ПУТЬ_К_TDLib>\example\java\build\Release".

### Установка TDLib в Debian 9

1. Необходимо установить/обновить дополнительные зависимости (при их отсутствии):
* sudo apt-get update
* sudo apt-get upgrade
* sudo cp /etc/apt/sources.list /etc/apt/sources.list.BACKUP
* sudo add-apt-repository "deb http://security.debian.org/ wheezy/updates main"
* sudo add-apt-repository "deb-src http://security.debian.org/ wheezy/updates main"
* sudo add-apt-repository "deb http://ftp.us.debian.org/debian wheezy main non-free"
* sudo add-apt-repository "deb-src http://ftp.us.debian.org/debian wheezy main non-free"
* sudo add-apt-repository "deb http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main"
* sudo apt-get update
* sudo apt-get install build-essential gcc-4.9 g++-4.9 openssl libssl-dev ccache gperf zlib1g zlib1g-dev cmake libreadline-dev git default-jre default-jdk software-properties-common oracle-java8-installer oracle-java8-set-default clang
* sudo cp /etc/apt/sources.list.BACKUP /etc/apt/sources.list
* sudo apt-get update
2. Выбрать место установки TDLib и клонировать репозиторий TDLib в эту директорию, здесь для примера указан путь "/usr/lib":
* cd /usr/lib
* git clone https://github.com/tdlib/td.git
* cd td
3. Собрать JNI:
* mkdir jnibuild
* cd jnibuild
* CXX=clang++ CC=clang cmake -DCMAKE_BUILD_TYPE=Release -DTD_ENABLE_JNI=ON -DCMAKE_INSTALL_PREFIX:PATH=../example/java/td ..
* CXX=clang++ CC=clang cmake --build . --target install
4. Собрать TDLib:
* cd /usr/lib/td/example/java
* mkdir build
* cd build
* CXX=clang++ CC=clang cmake -DCMAKE_BUILD_TYPE=Release -DTd_DIR=/usr/lib/td/example/java/td/lib/cmake/Td -DCMAKE_INSTALL_PREFIX:PATH=.. ..
* CXX=clang++ CC=clang cmake --build . --target install
5. Проект запускать со ссылкой на директорию с готовой библиотекой:
* java –Djava.library.path=/usr/lib/td/example/java/bin –jar CRM.jar
### Настройка Telegram
1. Зарегистрируйте аккаунт Telegram
2. Зайдите на https://my.telegram.org и авторизуйтесь
3. Перейдите по ссылке "API development tools" и заполните поля, выберите любое название приложения, тип приложения Desktop, краткое описание.
4. После успешного создания приложения, на следующие странице вы увидите данные приложения, нам необходимы "App api_id" и "App api_hash". Установите значения этих полей в конфигурационный файл telegram.properties в поля "telegram.apiId" и "telegram.apiHash".
5. Запустите CRM
6. После запуска CRM, зайдите под учетной записью администратора в настройки (Скриншот 24) и выберите пункт "Авторизация Telegram". Откроется диалоговое окно (Скриншот 54).
7. Введите номер телефона, к которому привязан ваш аккаунт телеграм, в международном формате (+70000000000) и нажмите иконку телефона справа.
8. Вам придет код (либо в Telegram, либо в SMS) для привязки приложения, введите этот код в поле и нажмите "Отправить".
9. Готово!
![alt text](https://pp.userapi.com/c844617/v844617291/1b83ef/KJjPnjBYadk.jpg)
***Авторизация в Telegram***

## Тесты
Тестирование ClientService на отдельной базе данных
---
класс ClientServiceTest
Перед запуском теста не забудьте создать базу данных crmtest, на которой будет происходить тестирование,
настройки хранятся в файле test\resources\application-test.properties,

если убрать (properties = "spring.profiles.active=test") в аннотации @SpringBootTest
тестирование произодет на реальной базе проекта

# Конец
